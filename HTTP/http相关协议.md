# https 与 http2

## 说在前面

### http 1.0 有哪些问题？
1. 没有长连接
早期Http/1.0 性能上一个很大的问题，就是每发起一个请求，都要建立一次TCP三次握手，和四次挥手
TCP 三次握手 -- 通信（request/response） -- TCP 四次挥手
TCP 三次握手 -- 通信（request/response） -- TCP 四次挥手
TCP 三次握手 -- 通信（request/response） -- TCP 四次挥手
TCP 三次握手 -- 通信（request/response） -- TCP 四次挥手

2. 队头阻塞

### http 1.1 是如何解决的？
1. 长连接
2. 支持管道传输
3. 队头阻塞，实际上http1.1这个问题，没有解决

## https
### http 有哪些风险
#### 安全性
http 超文本传输协议，信息是明文的，存在安全的问题
- 窃听风险；号没
- 篡改风险；眼没
- 冒充风险；钱没

### https 是怎么解决这些问题的
- CA证书：解决冒充风险
- 信息加密：解决窃听风险
- 校验机制：解决篡改风险

#### 信息加密
[混合加密]
对称加密，对称加密只有，一个密钥，运算速度很快，但是不够安全
非对称加密，两个密钥，公钥和私钥，公钥可以任意分发，私钥保密，但是速度慢

#### CA证书（Certificate）
- 公钥
- 持有者信息
- 证书认证机构信息
- CA 对这份文件的数字签名以及使用方法
- 证书有效期
- 额外信息

#### 校验机制


中间人手段

盐 10；
数据 hello
算法 对每一个字母加10 --> qouuz --> hello

确定：1. 加密算法；2. 密钥

### http2
#### http 1.1 性能上一个很大的问题
1. 队头阻塞
2. 头部，冗余且未压缩
3. 只能客户端发起

#### http2
首先，http2 协议，是基于https 的
1. 头部压缩
   HPACK 算法
    - 静态字典
     - 客户端和服务端都会共同维护一套字典
     - 1 -- 代表 authority
     - 2 -- 代表method / GET
     - 3 -- 代表method / POST
     - ...
     - 8 -- 代表 状态码 200
     - ...
     - 61 -- www-authenticate
    - 动态字典
     - 不在静态表范围内的，用动态表构建
     - 从 62 开始
    - 霍夫曼编码
2. 二进制帧
  - 将文本的格式，完全改成了二进制帧的格式
  - 帧的好处，在于使用位运算进行高效解析
3. 并发传输
  - 多个 Stream 复用一条 TCP 连接，达到一个并发的效果
  - 不同的Stream 顺序可以不一致，在到达时，进行组装
4. 服务端主动推送资源
  - http1.1使用websocket 协议
  - C -- S 基数号 Stream
  - S -- C 偶数号 Stream

#### 1. http2 有哪些缺点
1. TCP 协议 队头阻塞
2. TCP 和TLS 握手延迟
3. 网络迁移需要重新连接

#### 2. http 3 的特点
1. 使用QUIC + UDP， 取代 tcp 协议；
  1. 更快的连接建立
  2. 没有队头阻塞
2. 头部压缩，由 HPACK（61）升级成QPACK（91）


#### 3. 说一下http 的状态码

